# Проект документации на Diplodoc

## Описание проекта
Это проект документации, построенный на платформе **Diplodoc** (https://diplodoc.com/docs/ru/).

## Технологический стек

### Основные технологии
- **Diplodoc** - платформа для создания технической документации
- **YFM (Yandex Flavored Markdown)** - расширенный синтаксис Markdown
- **Node.js 20.x** - требуется для сборки документации
- **GitHub Pages** - хостинг для опубликованной документации

### Инструменты сборки
- `@diplodoc/cli` - CLI инструмент для сборки документации
- Команда сборки: `npx @diplodoc/cli -i ./docs -o ./docs-html`

## Структура проекта

```
.
├── docs/                    # Исходники документации
│   ├── ru/                 # Русская версия документации
│   │   ├── index.yaml      # Конфигурация главной страницы
│   │   ├── toc.yaml        # Оглавление (Table of Contents)
│   │   ├── about.md        # Страница "О проекте"
│   │   └── page.md         # Другие страницы
│   ├── _includes/          # Переиспользуемые фрагменты
│   └── .yfm                # Конфигурация YFM
├── .github/workflows/      # GitHub Actions workflows
│   ├── static.yml          # Основной workflow для деплоя на GitHub Pages
│   └── release.yml         # Workflow для релизов (отключен)
├── index.html              # Редирект с корня на /ru/
└── docs-html/              # Собранная документация (генерируется)
```

## Формат документации (YFM)

### Основные файлы

#### toc.yaml - Оглавление
Определяет структуру навигации:
```yaml
title: Название раздела
items:
  - name: Название страницы
    href: page.md
  - name: Подраздел
    items:
      - name: Вложенная страница
        href: subsection/page.md
```

#### index.yaml - Главная страница
Конфигурация главной страницы раздела:
```yaml
title: Заголовок
description: Описание
meta:
  title: SEO заголовок
```

#### Markdown файлы (.md)
Страницы документации в формате YFM (расширенный Markdown):
- Поддержка стандартного Markdown
- Дополнительные возможности: tabs, notes, cuts, includes
- Поддержка Mermaid диаграмм

### Специальные возможности YFM

#### Includes (вставки)
```markdown
{% include [текст](_includes/fragment.md) %}
```

#### Notes (заметки)
```markdown
{% note info %}
Информационная заметка
{% endnote %}
```

#### Tabs (вкладки)
```markdown
{% list tabs %}

- Вкладка 1
  Содержимое вкладки 1

- Вкладка 2
  Содержимое вкладки 2

{% endlist %}
```

#### Cuts (сворачиваемые блоки)
```markdown
{% cut "Заголовок" %}
Скрытое содержимое
{% endcut %}
```

## GitHub Actions Workflow

### Основной workflow (static.yml)
1. Checkout кода
2. Установка Node.js 20.x
3. Setup GitHub Pages
4. Сборка документации через `npx @diplodoc/cli`
5. Копирование `index.html` для редиректа
6. Деплой на GitHub Pages

### Важные моменты
- **Node.js 20.x обязателен** - более старые версии не поддерживаются пакетом `undici`
- Используется `npx` вместо глобальной установки для гарантии правильной версии Node.js
- `release.yml` отключен (только ручной запуск)

## Команды для разработки

### Локальная разработка
```bash
npm start                    # Запуск dev-сервера с hot-reload
npm run build:docs          # Сборка документации
```

### Сборка документации
```bash
npx @diplodoc/cli -i ./docs -o ./docs-html
```

## Правила работы с проектом

### При добавлении новых страниц
1. Создать `.md` файл в соответствующей директории (например, `docs/ru/`)
2. Добавить ссылку на страницу в `toc.yaml`
3. При необходимости обновить `index.yaml`

### При изменении структуры
1. Обновить `toc.yaml` для отражения новой структуры
2. Проверить, что все ссылки корректны
3. Пересобрать документацию локально для проверки

### При работе с includes
1. Размещать переиспользуемые фрагменты в `docs/_includes/`
2. Использовать относительные пути от текущего файла
3. Включать через `{% include [текст](_includes/file.md) %}`

## Troubleshooting

### Ошибка "File is not defined"
- Причина: используется Node.js < 20
- Решение: убедиться, что используется Node.js 20.x

### Ошибка сборки в GitHub Actions
- Проверить, что workflow использует `npx @diplodoc/cli@latest`
- Проверить, что Node.js 20.x установлен перед сборкой

### Проблемы с навигацией
- Проверить корректность путей в `toc.yaml`
- Убедиться, что все файлы существуют
- Проверить относительные пути в includes

## Полезные ссылки
- [Документация Diplodoc](https://diplodoc.com/docs/ru/)
- [Синтаксис YFM](https://diplodoc.com/docs/ru/syntax/)
- [GitHub Pages](https://pages.github.com/)
